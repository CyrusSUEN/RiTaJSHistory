function listFuncs(t){for(var e in t)"function"==typeof t[e]&&console.log(t[e])}!function(t,e){function n(t,e){var n="undefined"==typeof e?t.a||255:e;return[t.r,t.g,t.b,n]}function i(){var t=arguments,e=t.length,n=this&&this.alpha?this.alpha():255,r={r:0,g:0,b:0,a:n};return e?1==e&&x(t[0],m)?i.apply(this,t[0]):(e>=3&&(r.r=t[0],r.g=t[1],r.b=t[2]),4==e&&(r.a=t[3]),2>=e&&(r.r=t[0],r.g=t[0],r.b=t[0]),2==e&&(r.a=t[1]),r):r}function r(t){throw console&&console.log("err(msg) :: "+t),!RiTa.SILENT&&console&&console.trace(this),Error("[RiTa] "+t)}function s(){if(!RiTa.SILENT&&console&&arguments&&arguments.length){console.warn("[WARN] "+arguments[0]);for(var t=1;t<arguments.length;t++)console.warn("  "+arguments[t])}}function o(){return"undefined"!=typeof module&&module.exports}function a(){return function(t){return this instanceof arguments.callee?("function"==typeof this.init&&this.init.apply(this,t&&t.callee?t:arguments),void 0):new arguments.callee(arguments)}}function u(t,e){return x(t,d)?new RegExp(e+"$").test(t):!1}function h(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}o()&&require("./rita"),RiText=a(),RiText._animator={loopId:-1,actualFPS:0,targetFPS:60,isLooping:!1,frameCount:0,loopStarted:!1,framesSinceLastFPS:0,callbackDisabled:!1,timeSinceLastFPS:Date.now()};var c={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){var e,n=.1,i=.4;return 0===t?0:1===t?1:(!n||1>n?(n=1,e=i/4):e=i*Math.asin(1/n)/(2*Math.PI),-(n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)))},Out:function(t){var e,n=.1,i=.4;return 0===t?0:1===t?1:(!n||1>n?(n=1,e=i/4):e=i*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/i)+1)},InOut:function(t){var e,n=.1,i=.4;return 0===t?0:1===t?1:(!n||1>n?(n=1,e=i/4):e=i*Math.asin(1/n)/(2*Math.PI),(t*=2)<1?-.5*n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i):n*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)*.5+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?.5*t*t*((e+1)*t-e):.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-c.Bounce.Out(1-t)},Out:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return.5>t?.5*c.Bounce.In(2*t):.5*c.Bounce.Out(2*t-1)+.5}}},l={Linear:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),s=l.Utils.Linear;return 0>e?s(t[0],t[1],i):e>1?s(t[n],t[n-1],n-i):s(t[r],t[r+1>n?n:r+1],i-r)},Bezier:function(t,e){var n,i=0,r=t.length-1,s=Math.pow,o=l.Utils.Bernstein;for(n=0;r>=n;n++)i+=s(1-e,r-n)*s(e,n)*t[n]*o(r,n);return i},CatmullRom:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),s=l.Utils.CatmullRom;return t[0]===t[n]?(0>e&&(r=Math.floor(i=n*(1+e))),s(t[(r-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n],i-r)):0>e?t[0]-(s(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[n]-(s(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):s(t[r?r-1:0],t[r],t[r+1>n?n:r+1],t[r+2>n?n:r+2],i-r)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=l.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var t=[1];return function(e){var n,i=1;if(t[e])return t[e];for(n=e;n>1;n--)i*=n;return t[e]=i,t[e]}}(),CatmullRom:function(t,e,n,i,r){var s=.5*(n-t),o=.5*(i-e),a=r*r,u=r*a;return(2*e-2*n+s+o)*u+(-3*e+3*n-2*s-o)*a+s*r+e}}};RiText.LINEAR=c.Linear.None,RiText.EASE_IN=c.Exponential.In,RiText.EASE_OUT=c.Exponential.Out,RiText.EASE_IN_OUT=c.Exponential.InOut,RiText.EASE_IN_EXPO=c.Exponential.In,RiText.EASE_OUT_EXPO=c.Exponential.Out,RiText.EASE_IN_OUT_EXPO=c.Exponential.InOut,RiText.EASE_IN_SINE=c.Sinusoidal.In,RiText.EASE_OUT_SINE=c.Sinusoidal.Out,RiText.EASE_IN_OUT_SINE=c.Sinusoidal.InOut,RiText.EASE_IN_CUBIC=c.Cubic.In,RiText.EASE_OUT_CUBIC=c.Cubic.Out,RiText.EASE_IN_OUT_CUBIC=c.Cubic.InOut,RiText.EASE_IN_QUARTIC=c.Quartic.In,RiText.EASE_OUT_QUARTIC=c.Quartic.Out,RiText.EASE_IN_OUT_QUARTIC=c.Quartic.InOut,RiText.EASE_IN_QUINTIC=c.Quintic.In,RiText.EASE_OUT_QUINTIC=c.Quintic.Out,RiText.EASE_IN_OUT_QUINTIC=c.Quintic.InOut,RiText.BACK_IN=c.Back.In,RiText.BACK_OUT=c.Back.Out,RiText.BACK_IN_OUT=c.Back.InOut,RiText.BOUNCE_IN=c.Bounce.In,RiText.BOUNCE_OUT=c.Bounce.Out,RiText.BOUNCE_IN_OUT=c.Bounce.InOut,RiText.CIRCULAR_IN=c.Circular.In,RiText.CIRCULAR_OUT=c.Circular.Out,RiText.CIRCULAR_IN_OUT=c.Circular.InOut,RiText.ELASTIC_IN=c.Elastic.In,RiText.ELASTIC_OUT=c.Elastic.Out,RiText.ELASTIC_IN_OUT=c.Elastic.InOut,RiText._defaults={fill:{r:0,g:0,b:0,a:255},fontFamily:"Times New Roman",alignment:RiTa.LEFT,motionType:RiText.LINEAR,_font:null,fontSize:14,paragraphLeading:0,paragraphIndent:30,indentFirstParagraph:!1,boundingStroke:null,boundingStrokeWeight:1,showBounds:!1,boundingFill:null,leadingFactor:1.2,rotateX:0,rotateY:0,rotateZ:0,scaleX:1,scaleY:1,scaleZ:1,metrics:{name:"Times New Roman",size:14,ascent:9.744,descent:3.024,widths:{0:7,1:7,2:7,3:7,4:7,5:7,6:7,7:7,8:7,9:7,"!":5,'"':6,"#":7,$:7,"%":12,"&":11,"'":3,"(":5,")":5,"*":7,"+":8,",":4,"-":5,".":4,"/":4,":":4,";":4,"<":8,"=":8,">":8,"?":6,"@":13,A:10,B:9,C:9,D:10,E:9,F:8,G:10,H:10,I:5,J:5,K:10,L:9,M:12,N:10,O:10,P:8,Q:10,R:9,S:8,T:9,U:10,V:10,W:13,X:10,Y:10,Z:9,"[":5,"\\":4,"]":5,"^":7,_:7,"`":5,a:6,b:7,c:6,d:7,e:6,f:5,g:7,h:7,i:4,j:4,k:7,l:4,m:11,n:7,o:7,p:7,q:7,r:5,s:5,t:4,u:7,v:7,w:10,x:7,y:7,z:6,"{":7,"|":3,"}":7," ":4}}};var f=function(t,n){var i=t,s=n||i,o={},a={},u=1e3,h=0,f=null,_=c.Linear.None,x=l.Linear,p=null,g=null,T=null;this.to=function(t,e){return null!==e&&(u=e),a=t,this},this.start=function(t){i?i._addBehavior(this):r("Unable to add tween"),f=t!==e?t:Date.now(),f+=h;for(var n in a)if(null!==s[n]){if(a[n]instanceof Array){if(0===a[n].length)continue;a[n]=[s[n]].concat(a[n])}o[n]=s[n]}else console.error("null value in interpolater for: "+n);return this},this.stop=function(){return i&&i.stopBehavior(this),this},this.delay=function(t){return h=t,this},this.easing=function(t){return t||r("null easing!!"),_=t,this},this.interpolation=function(t){return x=t,this},this.chain=function(t){return p=t,this},this.onUpdate=function(t){return g=t,this},this.onComplete=function(t){return T=t,this},this.update=function(t){if(f>t)return!0;var e=(t-f)/u;e=e>1?1:e;var n=_(e);for(var i in o){var r=o[i],h=a[i];s[i]=h instanceof Array?x(h,n):r+(h-r)*n}return g&&g.call(s,n),1==e?(null!==T&&T.call(s),null!==p&&p.start(),!1):!0}},_={N:"number",S:"string",O:"object",A:"array",B:"boolean",R:"regexp",F:"function",get:function(t){return"undefined"==typeof t?null:{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},is:function(t,e){return _.get(t)===e},ok:function(t,e){if(_.get(t)!=e)throw TypeError("Expected "+(e?e.toUpperCase():e+"")+", but received "+(t?_.get(t).toUpperCase():t+""));return!0}},x=_.is,p=(_.ok," "),g="",T=_.N,d=_.S,R=_.O,m=_.A,v=(_.B,_.R,_.F);RiText._graphics=function(){return RiText.renderer?RiText.renderer._getGraphics():null},RiText.loop=function(){var e,n=arguments,i=RiText.renderer,r=RiText._animator,o="undefined"!=typeof t?t.draw:null;if("Processing"!==i._type()&&!r.loopStarted){switch(n.length){case 1:n[0]&&(e=_.get(n[0]),e==v?o=n[0]:e==T&&(r.targetFPS=n[0]));break;case 2:n[0]&&(e=_.get(n[0]),e==v&&(o=n[0]),e=_.get(n[1]),e==T&&(r.targetFPS=n[1]))}r.timeSinceLastFPS=Date.now(),r.framesSinceLastFPS=0;var a=1e3/r.targetFPS;o&&!r.callbackDisabled&&t&&(r.loopId=t.setInterval(function(){try{o();var e=(Date.now()-r.timeSinceLastFPS)/1e3,n=++r.framesSinceLastFPS/e;e>.5&&(r.timeSinceLastFPS=Date.now(),r.framesSinceLastFPS=0,r.actualFPS=n),r.frameCount++}catch(i){throw r.callbackDisabled||(s("Unable to invoke callback: "+o),r.callbackDisabled=!0),t.clearInterval(r.loopId),console.trace(this),i}},a),r.isLooping=!0,r.loopStarted=!0)}},RiText.randomColor=function(t,e,n){t=t||0,e=e||256;var i=[RiText.random(t,e),RiText.random(t,e),RiText.random(t,e)];return n&&i.push(RiText.random(t,e)),i},RiText.random=function(){return RiTa.random.apply(this,arguments)},RiText.picked=function(t,e){for(var n=[],i=0;i<RiText.instances.length;i++){var r=RiText.instances[i];r.contains(t,e)&&n.push(r)}return n},RiText._disposeOne=function(t){for(var e=RiText.instances;-1!==e.indexOf(t);)e.splice(e.indexOf(t),1);t&&(delete t.rs,t={},t._rs={})},RiText._disposeArray=function(t){for(var e=0;e<t.length;e++)RiText._disposeOne(t[e]);t=[]},RiText.dispose=function(t){x(t,m)&&RiText._disposeArray(t),x(t,R)&&RiText._disposeOne(t)},RiText.disposeAll=function(){arguments.length?RiText.dispose(arguments[0]):(RiText._disposeArray(RiText.instances),RiText.instances=[])},RiText.createWords=function(t,e,n,i,r,s,o){return RiText._createRiTexts(t,e,n,i,r,s,o,RiText.prototype.splitWords)},RiText.createLetters=function(t,e,n,i,r,s,o){return RiText._createRiTexts(t,e,n,i,r,s,o,RiText.prototype.splitLetters)},RiText.defaultFontSize=function(t){return arguments.length?(RiText.defaults.fontSize!=t&&(RiText.defaults.fontSize=t,RiText.defaults._font=null),void 0):RiText.defaults.fontSize},RiText.defaultFont=function(){var t=arguments;return t.length>1&&!Number(t[1])&&(t=[t[0]]),1==t.length?(x(t[0],R)&&(o()&&t[0].widths&&RiText.renderer._textFont(t[0]),t[0].name&&(RiText.defaults.fontFamily=t[0].name),RiText.defaults._font=t[0]),x(t[0],d)&&(/\.vlw$/.test(t[0])&&(s(".vlw fonts not supported in RiTaJS! Ignoring: '"+t[0]+"'"),t[0]=RiText.defaults.fontFamily),RiText.defaults.fontFamily=t[0],RiText.defaults._font=RiText.renderer._createFont(t[0],RiText.defaults.fontSize))):t.length>1?(x(t[0],R)&&(t[0]=t[0].name),x(t[0],d)?(RiText.defaults.fontFamily=t[0],RiText.defaults._font=RiText.renderer._createFont(t[0],t[1])):r("Unexpected type: "+typeof t[0])):0!==t.length||RiText.defaults._font||(RiText.defaults._font=o()?RiText.defaults.metrics:RiText.renderer._createFont(RiText.defaults.fontFamily,RiText.defaults.fontSize)),RiText.defaults._font},RiText._fontMetrics=function(t){var e,n,i,r={},s=RiText.defaultFont();if(!t||!t.length)for(t=[],n=33;126>n;n++)t.push(String.fromCharCode(n));for(x(t,d)&&(t=t.split(g)),e=0;e<t.length;e++)i=t[e],r[i]=s.measureTextWidth(i);return r[p]=s.measureTextWidth(p),{name:s.name,size:s.size,ascent:s.ascent,descent:s.descent,widths:r}},RiText._createFont=function(t,e){return t||r("RiText._createFont requires fontName"),e=e||RiText.defaults.fontSize,RiText.renderer._createFont(t,e)},RiText.drawAll=function(t){if(1==arguments.length&&x(t,m))for(var e=0;e<t.length;e++)t[e]&&t[e].draw();else for(var n=0;n<RiText.instances.length;n++)RiText.instances[n]&&RiText.instances[n].draw()},RiText.defaultFill=function(){return arguments.length&&(RiText.defaults.fill=i.apply(null,arguments)),n(RiText.defaults.fill)},RiText._layoutArray=function(t,e,n,i,r,s,o){if(!x(arguments[0],m)){var a=arguments;t=a[1],e=a[2],n=a[3],i=a[4],r=a[5],s=a[6],o=a[7]}var u=[];if(!t||!t.length)return u;for(var h=0;h<t.length;h++)u.push(RiText(t[h],e+1,n).font(s));return RiText._constrainLines(u,n,r,o)},RiText._constrainLines=function(t,e,n,i){var r,s,o=t[0].textAscent(),a=t[0].textDescent(),u=e+n,h=e+o+1;for(r=0;r<t.length&&(s=t[r],s.y=h,RiText._withinBoundsY(h,i,u,a));r++)h+=i;var c=t.slice(r+1);RiText.dispose(c);var l=t.slice(0,r);return l},RiText.resetDefaults=function(){RiText.defaults=RiText._defaults},RiText.boundingBox=function(t){var e=t,n=Number.MAX_VALUE,i=-Number.MAX_VALUE,r=Number.MAX_VALUE,s=-Number.MAX_VALUE;x(e,m)||(e=[t]);for(var o=0,a=e.length;a>o;o++){var u=e[o].boundingBox();u[0]<n&&(n=u[0]),u[1]<r&&(r=u[1]),u[0]+u[2]>i&&(i=u[0]+u[2]),u[1]+u[3]>s&&(s=u[1]+u[3])}return[n,r,i-n,s-r]},RiText.createLines=function(t,e,n,i,r,s,o){var a=arguments,u=_.get(a[0]),h=RiText.renderer;if(u!=d&&u!=m&&(t=a[1],e=a[2],n=a[3],i=a[4],r=a[5],s=a[6],o=a[7]),!t||!t.length)return[];if(r=r&&r>0?r:Number.MAX_VALUE,s=s||RiText.defaultFont(),o=o||s.size*RiText.defaults.leadingFactor,x(t,m)){if(!i)return RiText._layoutArray(t,e,n,i,r,s,o);t=t.join(p)}!i&&h&&h.width&&(i=h.width-e),0>i&&(i=Number.MAX_VALUE);var c,l,f,T,R,v=e,y=[],I=g,w=[],A=0,S=null,E=!1,b=!1,O=!0,F=e+i,C=n+r;if(h&&h.p||(S=RiText(p,0,0,s)),t=t.replace(/&gt;/g,">"),t=t.replace(/&lt;/g,"<"),t=t.replace(/ ?(<[^>]+>) ?/g," $1 "),t=t.replace(/[\r\n]/g,p),RiText._addToStack(t,w),!w.length)return RiText.EMPTY_ARRAY;for(h._textFont(s),c=h.p?h.p.textAscent():h._textAscent(S,!0),l=h.p?h.p.textDescent():h._textDescent(S,!0),T=n+c,RiText.defaults.indentFirstParagraph&&(v+=RiText.defaults.paragraphIndent);w.length>0;)if(R=w.pop(),R.length)if(/<[^>]+>/.test(R))R==RiText.NON_BREAKING_SPACE?I+=p:R==RiText.PARAGRAPH_BREAK?E=!0:R==RiText.LINE_BREAK&&(b=!0);else if(f=v+h._textWidth(s,I+R),!E&&!b&&F>f)I+=R+p;else{if(!RiText._withinBoundsY(T,o,C,l,O)){w.push(R);break}A=O?T:T+o,S=RiText._newRiTextLine(I,s,v,A),y.push(S),T=E?S.y+RiText.defaults.paragraphLeading:S.y,v=e,E&&(v+=RiText.defaults.paragraphIndent),I=R+p,E=!1,b=!1,O=!1}return RiText._withinBoundsY(T,o,C,l,O)?(A=O?T:T+o,y.push(RiText._newRiTextLine(I,s,e,A)),I=g):RiText._addToStack(I,w),y},RiText._withinBoundsY=function(t,e,n,i,r){return r?n-i>=t:n-i>=t+e},RiText._addToStack=function(t,e){for(var n=t.split(p),i=n.length-1;i>=0;i--)e.push(n[i])},RiText._newRiTextLine=function(t,e,n,i){for(;t&&t.length>0&&u(t,p);)t=t.substring(0,t.length-1);return new RiText(t,n,i,e)},RiText._createRiTexts=function(t,e,n,i,r,s,o,a){var u=RiText.createLines(t,e,n,i,r,s,o);if(!u||u.length<1)return[];for(var h=[],c=(u[0].font(),0);c<u.length;c++){for(var l=a.call(u[c]),f=0;f<l.length;f++)h.push(l[f].font(s));RiText.dispose(u[c])}return h},RiText._wordOffsetFor=function(t,e,n){if(0>n||n>=e.length)throw new Error("Bad wordIdx="+n+" for "+e);t.g._push();var i=t.x;if(n>0){for(var r=e.slice(0,n),o="",a=0;a<r.length;a++)o+=r[a]+" ";var u=t.g._textWidth(t._font,o);switch(t._alignment){case RiTa.LEFT:i=t.x+u;break;case RiTa.RIGHT:i=t.x-u;break;case RiTa.CENTER:s("TODO: test center-align here"),i=t.x}}return t.g._pop(),i},RiText._handleLeading=function(t,e,n){if(e&&e.length){t=t||RiText._getDefaultFont();var i=n;e[0].font(t);for(var r=0;r<e.length;r++)e[r].y=i,i+=t.leading;return e}},RiText._getDefaultFont=function(){return RiText.defaults._font=RiText.defaults._font||RiText.renderer._createFont(RiText.defaults.fontFamily,RiText.defaults.fontSize),RiText.defaults._font},RiText.timer=RiTa.timer,RiText.pauseTimer=RiTa.pauseTimer,RiText.stopTimer=RiTa.stopTimer,RiText.NON_BREAKING_SPACE="<sp/>",RiText.PARAGRAPH_BREAK="<p/>",RiText.LINE_BREAK="<br/>",RiText.instances=[],RiText.defaults=RiText._defaults,RiText.prototype={init:function(){var t,e,n;RiText.renderer||r("No graphics context, RiText unavailable"),this._color={r:RiText.defaults.fill.r,g:RiText.defaults.fill.g,b:RiText.defaults.fill.b,a:RiText.defaults.fill.a},this._boundingStrokeWeight=RiText.defaults.boundingStrokeWeight,t=RiText.defaults.boundingStroke,this._boundingStroke={r:t&&t.r||this._color.r,g:t&&t.g||this._color.g,b:t&&t.b||this._color.b,a:this._color.a},this._boundingFill=RiText.defaults.boundingFill,this._showBounds=RiText.defaults.showBounds,this._motionType=RiText.defaults.motionType,this._alignment=RiText.defaults.alignment,this._rotateX=RiText.defaults.rotateX,this._rotateY=RiText.defaults.rotateY,this._rotateZ=RiText.defaults.rotateZ,this._scaleX=RiText.defaults.scaleX,this._scaleY=RiText.defaults.scaleY,this._scaleZ=1,this._behaviors=[],this.g=RiText.renderer,n=this._initArgs.apply(this,arguments),this.font(n[3]),this.text(n[0]),this.x=x(n[1],T)?n[1]:this._screenCenterX(),e=this.g&&this.g.p?this.g.p.height/2:50,this.y=x(n[2],T)?n[2]:e+this.textHeight()/2,this.z=0,RiText.instances.push(this)},_initArgs:function(){var t=arguments,e=_.get(t[0]);if(t.length&&(e===R||"global"===e||"window"===e)&&typeof t[0].analyze!=v){var n=Array.prototype.slice.call(t,1);return this._initArgs.apply(this,n)}var i=[g,null,null,null];return t.length&&(x(t[0],d)?i[0]=t[0]:x(t[0],R)&&typeof t[0].text==v?i[0]=t[0].text():x(t[0],T)?i[0]=String.fromCharCode(t[0]):RiTa.SILENT||console.error("Unexpected arg in RiText("+t[0]+" [type="+typeof t[0]+"])")),t.length>1&&(i[1]=t[1]),t.length>2&&(i[2]=t[2]),t.length>3&&(i[3]=t[3]),i},_screenCenterX:function(){var t=this.g&&this.g.p?this.g.p.width/2:-1;return this._alignment==RiTa.LEFT?t-=this.textWidth()/2:this._alignment==RiTa.RIGHT&&(t+=this.textWidth()/2),t},get:function(t){return this._rs.get(t)},features:function(){return this._rs.features()},draw:function(){return this._update()._render(),this.textToCopy&&this.textToCopy.draw(),this},_update:function(){return this._behaviors.length&&this._updateBehaviors(),this},_render:function(){var t=this.g;if(t||r("no-renderer"),this._rs&&this._rs.length){t._push();var e=t._getBoundingBox(this);if(t._translate(this.x,this.y),t._translate(e.width/2,e.height/-4),t._rotate(this._rotateZ),t._translate(e.width/-2,e.height/4),t._scale(this._scaleX,this._scaleY,this._scaleZ),t._fill(this._color.r,this._color.g,this._color.b,this._color.a),t._textFont(this._font),t._textAlign(this._alignment),t._text(this._rs._text,0,0),this._showBounds){switch(this._boundingFill?t._fill(this._boundingFill.r,this._boundingFill.g,this._boundingFill.b,this._color.a):t._noFill(),t._stroke(this._boundingStroke.r,this._boundingStroke.g,this._boundingStroke.b,this._color.a),t._strokeWeight(this._boundingStrokeWeight),this._alignment){case RiTa.RIGHT:t._translate(-e.width,0);break;case RiTa.CENTER:t._translate(-e.width/2,0)}t._rect(0,e.y,e.width,e.height)}t._pop()}return this},motionType:function(t){return arguments.length?(this._motionType=t,this):this._motionType},fadeIn:function(t,e){return this.colorTo(n(this._color,255),t,e,null,RiTa.FADE_IN,!1)},fadeOut:function(t,e,i,r){return r=r||!1,this.colorTo(n(this._color,0),t,e,null,RiTa.FADE_OUT,r)},scaleTo:function(t,e,n,i){var r=this;n=n||0,e=e||1;var s=setTimeout(function(){var n=new f(r).to({_scaleX:t,_scaleY:t},1e3*e).easing(r._motionType).onUpdate(function(){r._scaleX=this._scaleX,r._scaleY=this._scaleY}).onComplete(function(){RiTaEvent(r,RiTa.SCALE_TO)._fire(i)});n.start()},1e3*n);return s},rotateTo:function(t,e,n,i){var r=this;n=n||0,e=e||1;var s=setTimeout(function(){var n=new f(r).to({_rotateZ:t},1e3*e).easing(r._motionType).onUpdate(function(){r._rotateZ=this._rotateZ}).onComplete(function(){RiTaEvent(r,RiTa.ROTATE_TO)._fire(i)});n.start()},1e3*n);return s},textTo:function(t,e,i,r){var s=this._color,o=0,a=s.a;return this.textToCopy&&(o=this.textToCopy.alpha(),RiText.dispose(this.textToCopy)),this.textToCopy=this.copy(),this.textToCopy.colorTo(n(s,0),e/2,i,null,RiTa.INTERNAL,!0),RiText.dispose(this.textToCopy.textToCopy),this.text(t).alpha(o),this.colorTo(n(s,a),.95*e,i,r,RiTa.TEXT_TO,!1)},colorTo:function(t,e,n,s,o,a){x(t,m)||r("arg#1 to colorTo() must be an array"),n=n||0,e=e||1,t=i.apply(this,t),o=o||RiTa.COLOR_TO;var u=this,h=setTimeout(function(){new f(u,u._color).to({r:t.r,g:t.g,b:t.b,a:t.a},1e3*e).easing(u._motionType).onUpdate(function(){u._color.r=this.r,u._color.g=this.g,u._color.b=this.b,u._color.a=this.a,u._boundingStroke.a=this.a}).onComplete(function(){o!=RiTa.INTERNAL&&RiTaEvent(u,o)._fire(s),a&&RiText.dispose(u)}).start()},1e3*n);return h},moveTo:function(t,e,n,i,r){var s=this;i=i||0,n=n||1;var o=setTimeout(function(){new f(s).to({x:t,y:e},1e3*n).easing(s._motionType).onUpdate(function(){s.x=this.x,s.y=this.y}).delay(i).onComplete(function(){RiTaEvent(s,RiTa.MOVE_TO)._fire(r)}).start()},1e3*i);return o},analyze:function(){return this._rs.analyze(),this},text:function(t){if(1==arguments.length){var e=_.get(t);return e==T?t=String.fromCharCode(t):e==R&&typeof t.text==v&&(t=t.text()),this._rs=this._rs?this._rs.text(t):new RiString(t),this}return this._rs._text},match:function(t){return this._rs.match(t)},charAt:function(t){return this._rs.charAt(t)},concat:function(t){return this._rs._text.concat(t.text())},containsWord:function(t){return this._rs.indexOf(t)>-1},endsWith:function(t){return u(this._rs._text,t)},equals:function(t){return t._rs._text===this._rs._text},equalsIgnoreCase:function(t){return typeof t===d?t.toLowerCase()===this._rs._text.toLowerCase():t.text().toLowerCase()===this._rs._text.toLowerCase()},indexOf:function(t,e){return this._rs._text.indexOf(t,e)},lastIndexOf:function(t,e){return this._rs._text.lastIndexOf(t,e)},length:function(){return this._rs._text.length},pos:function(){for(var t=RiTa.tokenize(this._rs._text),e=RiTa.getPosTags(t),n=0,i=e.length;i>n;n++)typeof e[n]===d&&e[n].length>0||r("RiText: can't parse pos for:"+t[n]);return e},posAt:function(t){var e=this._rs.pos();return!e||!e.length||0>t||t>=e.length?g:e[t]},insertChar:function(){return this._rs.insertChar.apply(this._rs,arguments),this},removeChar:function(){return this._rs.removeChar.apply(this._rs,arguments),this},replaceChar:function(){return this._rs.replaceChar.apply(this._rs,arguments),this},replaceFirst:function(){return this._rs.replaceFirst.apply(this._rs,arguments),this},replaceAll:function(){return this._rs.replaceAll.apply(this._rs,arguments),this},replaceWord:function(){return this._rs.replaceWord.apply(this._rs,arguments),this},removeWord:function(){return this._rs.removeWord.apply(this._rs,arguments),this},insertWord:function(){return this._rs.insertWord.apply(this._rs,arguments),this},slice:function(t,e){var n=this._rs._text.slice(t,e)||g;return this._rs.text(n)},startsWith:function(t){return 0===this._rs.indexOf(t)},substring:function(t,e){return this._rs.text(this._rs._text.substring(t,e))},substr:function(t,e){var n=this._rs._text.substr(t,e);return this._rs.text(n)},toLowerCase:function(){return this._rs.text(this._rs._text.toLowerCase())},toUpperCase:function(){return this._rs.text(this._rs._text.toUpperCase())},trim:function(){return this._rs.text(h(this._rs._text))},wordAt:function(t){var e=RiTa.tokenize(this._rs._text);return 0>t||t>=e.length?g:e[t]},wordCount:function(){return this._rs._text.length?this.words().length:0},words:function(){return RiTa.tokenize(this._rs._text)},distanceTo:function(t,e){var n,i,r,s=this.center();return 1==t.length&&x(t.center,v)?(r=t.center(),n=r[0],i=r[1]):(n=t,i=e),RiTa.distance(s[0],s[1],n,i)},center:function(){var t=this.boundingBox();return[t[0]+t[2]/2,t[1]+t[3]/2]},splitWords:function(t){t=t||p,typeof t==d&&(t=new RegExp(t));for(var e=[],n=this._rs._text,i=n.split(t),r=0;r<i.length;r++)if(!(i[r].length<1)){var s=this.copy();s.text(i[r]);var o=RiText._wordOffsetFor(this,i,r);s.position(o,this.y),e.push(s)}return e},splitLetters:function(){for(var t=[],e=[],n=this.text(),i=n.length,r=0;i>r;r++)e[r]=n.charAt(r);for(var s=0;s<e.length;s++)if(e[s]!=p){var o=this.copy();o.text(e[s]);var a=this.charOffset(s);o.position(a,this.y),t.push(o)}return t},contains:function(t,e){var n=this.boundingBox(!0);return n[0]+=this.x,n[1]+=this.y,!(t<n[0]||t>n[0]+n[2]||e<n[1]||e>n[1]+n[3])},copy:function(){var t=new RiText(this.text(),this.x,this.y,this._font);t.fill(this._color.r,this._color.g,this._color.b,this._color.a);for(var e in this)typeof this[e]!=v&&typeof this[e]!=R&&(t[e]=this[e]);return t},align:function(t){return arguments.length?(this._alignment=t,this):this._alignment},font:function(t){var e=arguments;return 1==e.length?x(t,d)?/\.vlw$/.test(t)?(s(".vlw fonts not supported in RiTaJS! Ignoring: '"+t+"'"),this._font=RiText._getDefaultFont(),this):(this._font=RiText.renderer._createFont(t,RiText.defaults.fontSize),this):(this._font=t||RiText._getDefaultFont(),this):2==e.length?(this._font=RiText.renderer._createFont(e[0],e[1]),this):this._font},showBounds:function(t){return 1==arguments.length?(this._showBounds=t,this):this._showBounds},fill:function(){return 0===arguments.length?this._color:(this._color=i.apply(this,arguments),this)},boundingFill:function(){return 0===arguments.length?this._boundingFill:(this._boundingFill=i.apply(this,arguments),this)},boundingStroke:function(){return 0===arguments.length?this._boundingStroke:(this._boundingStroke=i.apply(this,arguments),this)},isVisible:function(){return arguments.length&&r("isVisible() takes no arguments"),this._color.a>0},alpha:function(t){return 1==arguments.length?(this._color.a=t,this):this._color.a},position:function(t,e){return arguments.length?(this.x=t,this.y=e,this):[this.x,this.y]},rotate:function(t){return arguments.length?(this._rotateZ=t,this):[this._rotateZ]},scale:function(t,e){return arguments.length?(1==arguments.length&&(e=t),this._scaleX=t,this._scaleY=e,this):{x:this._scaleX,y:this._scaleY}},charOffset:function(t){var e=this.x;if(t>0){var n=this.text(),i=n.length;t>i&&(t=i);var r=n.substring(0,t);e=this.x+this.g._textWidth(this._font,r)}return e},wordOffset:function(t){return RiText._wordOffsetFor(this,this.words(),t)},boundingBox:function(t){var e=this.g,n=this.g._getBoundingBox(this);return e._push(),e._translate(this.x,this.y),e._translate(n.width/2,n.height/-4),e._rotate(this._rotateZ),e._translate(n.width/-2,n.height/4),e._scale(this._scaleX,this._scaleY,this._scaleZ),e._textFont(this._font),e._textAlign(this._alignment),t||(n.x+=this.x,n.y+=this.y,n.width*=this._scaleX,n.height*=this._scaleY),e._pop(),[n.x,n.y,n.width,n.height]},textWidth:function(){return this.g._textWidth(this._font,this._rs._text)},textHeight:function(){return this.g._textHeight(this)},fontSize:function(t){if(!arguments.length)return this._font?this._font.size:-1;if(this._font&&this._font.size==t)return this;var e=RiText.defaults.fontFamily;return this._font&&this._font.name&&(e=this._font.name),this.font(e,t),this},textAscent:function(){return this.g._textAscent(this)},textDescent:function(){return this.g._textDescent(this)},_addBehavior:function(t){this._behaviors.push(t)},_getBehavior:function(t){for(var e=0;e<this._behaviors.length;e++)if(this._behaviors[e].id==t)return this._behaviors[e].id;return null},stopBehavior:function(t){var e=this._getBehavior(t);if(e){var n=this._behaviors.indexOf(e);-1!==n&&this._behaviors.splice(n,1)}return this},stopBehaviors:function(){return this._behaviors=[],this},_updateBehaviors:function(t){for(var e=0,n=this._behaviors.length,i=t||Date.now();n>e;)this._behaviors[e].update(i)?e++:(this._behaviors.splice(e,1),n--)},toString:function(){var t=this._rs&&this._rs._text||"undef";return"["+Math.round(this.x)+","+Math.round(this.y)+",'"+t+"']"}};var y=a();y.prototype={init:function(t){this.p=t},_getGraphics:function(){return this.p},_push:function(){return push(),this},_pop:function(){return pop(),this},_textAlign:function(t){return textAlign(t),this},_scale:function(t,e){return scale(t,e),this},_translate:function(t,e){return translate(t,e),this},_rotate:function(t){return rotate(t),this},_text:function(t,e,n){return text(t,e,n),this},_fill:function(t,e,n,i){return fill(t,e,n,i),this},_stroke:function(t,e,n,i){return stroke(t,e,n,i),this},_noFill:function(){return noFill(),this},_noStroke:function(){return noStroke(),this},_strokeWeight:function(t){return strokeWeight(t),this},_createFont:function(t,e){return textFont(t),textSize(e),this.font={name:t,size:e},this.font},_rect:function(t,e,n,i){return rect(t,e,n,i),this},_textFont:function(t){x(t,R)||r("_textFont takes object!"),textFont(t,t.size)},_textSize:function(t){textSize(t)},_textWidth:function(t,e){this._push(),textFont(this.font),textSize(this.fontSize);var n=textWidth(e);return this._pop(),n},_textHeight:function(t){this._push();var e=this._getBoundingBox(t).height;return this._pop(),e},_textAscent:function(t,e){e=e||!1,e||(this._push(),textFont(t._font,t._font.size));var n=textAscent();return e||this._pop(),n},_textDescent:function(t){this._push(),textFont(t._font,t._font.size);var e=textDescent();return this._pop(),e},_getBoundingBox:function(t){this._push(),textFont(t._font),textSize(t._font.size);var e=textAscent(),n=textDescent(),i=textWidth(t.text());return this._pop(),{x:0,y:-e-1,width:i,height:e+n+1}},_width:function(){throw Error("no width in node")},_type:function(){return"P5js"},toString:function(){return"RiText_"+this._type()}};var I=a();I.prototype={init:function(t){this.font=t},_getGraphics:function(){return s("NodeRenderer._getGraphics() returning null graphics context!"),null},_push:function(){return this},_pop:function(){return this},_textAlign:function(){return this},_scale:function(){},_translate:function(){},_rotate:function(){},_text:function(){},_fill:function(){},_stroke:function(){},_noFill:function(){},_strokeWeight:function(){},_createFont:function(){return this.font},_rect:function(){},_textFont:function(t){this.font=t},_textWidth:function(t,e){var n=0,i=this.font.widths.i;if(e&&e.length)for(var r=0;r<e.length;r++){var o=e.charAt(r);if("\n"!=o&&"\r"!=o){var a=this.font.widths[o];a||(s('No glyph for "'+o+'"in word: '+e),a=i),n+=a}}return n},_textHeight:function(){return this._textAscent()+this._textDescent()},_textAscent:function(){return this.font.ascent},_textDescent:function(){return this.font.descent},_getBoundingBox:function(t){return{x:t.x,y:t.y-this._textAscent()-1,width:this._textWidth(),height:this._textAscent()+this._textDescent()+1}},_width:function(){throw Error("no width in node")},_type:function(){return"Node"},toString:function(){return"RiText_"+this._type()}};var w=a();w.prototype={init:function(t,e){this.p=t,this.ctx=e},_getGraphics:function(){return this.p},_push:function(){return this.ctx?this.ctx.save():push(),this},_pop:function(){return this.ctx?this.ctx.restore():pop(),this},_textAlign:function(){return this.p.textAlign.apply(this,arguments),this},_scale:function(t,e){e=e||1,this.p.scale(t,e,1)},_translate:function(t,e){e=e||0,this.p.translate(t,e,0)},_rotate:function(t){this.p.rotate(t)},_text:function(){this.p.text.apply(this,arguments)},_fill:function(){this.p.fill.apply(this,arguments)},_stroke:function(){this.p.stroke.apply(this,arguments)},_noFill:function(){this.p.noFill()},_rect:function(){this.p.rect.apply(this,arguments)},_strokeWeight:function(){this.p.strokeWeight.apply(this,arguments)},_background:function(){this.p.background.apply(this,arguments)},_createFont:function(t,e){return this.p.createFont&&this.p.createFont(t,e)},_textFont:function(t){x(t,R)||r("_textFont takes object!"),this.p.textFont(t,t.size)},_textSize:function(t){this.p.textSize(t)},_textWidth:function(t,e){this._push(),this.p.textFont(t,t.size);var n=this.p.textWidth(e);return this._pop(),n},_textHeight:function(t){this._push();var e=this._getBoundingBox(t).height;return this._pop(),e},_textAscent:function(t,e){e=e||!1,e||(this._push(),this.p.textFont(t._font,t._font.size));var n=this.p.textAscent();return e||this._pop(),n},_textDescent:function(t){this._push(),this.p.textFont(t._font,t._font.size);var e=this.p.textDescent();return this._pop(),e},_getBoundingBox:function(t){this._push(),this.p.textFont(t._font,t._font.size);var e=this.p.textAscent(),n=this.p.textDescent(),i=this.p.textWidth(t.text());return this._pop(),{x:0,y:-e-1,width:i,height:e+n+1}},_width:function(){return this.p.width},_type:function(){return"Processing"},toString:function(){return"RiText_"+this._type()}};var A,S="undefined"!=typeof p5,E="undefined"!=typeof Processing;E?Processing.registerLibrary("RiTa",{attach:function(t){t&&t.externals&&t.externals.canvas&&(A=t.externals.canvas.getContext("2d")),RiText.renderer=new w(t,A)
}}):S?console.warn("No support yet for p5.js"):(o()||t||s("Env. is not Processing(JS)/p5.js, Node, or Android; rendering unavailable"),RiText.renderer=I(RiText.defaults.metrics)),t&&(t.RiText=RiText),o()&&(module.exports.RiText=RiText)}("undefined"!=typeof window?window:null);